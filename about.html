<!DOCTYPE html>
<html lang="en" id="html-root">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="About Md Fahim, Doing something" />
    <title>About | Academic Profile</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles/animations.css" />
    <script src="https://cdn.tailwindcss.com?plugins=typography,forms"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  </head>

  <body
    class="font-sans bg-slate-50 text-slate-700 dark:bg-slate-900 dark:text-slate-300 min-h-screen flex flex-col transition-colors duration-300"
  >
    <div id="header-partial"></div>

    <main
      class="flex-1 w-full max-w-6xl mx-auto px-4 pb-10 flex flex-col lg:flex-row gap-12 pt-28"
    >
      <!-- SIDEBAR -->
      <aside class="w-full lg:w-80 flex-shrink-0 lg:sticky lg:top-24 h-fit">
        <div
          class="rounded-2xl bg-white/50 dark:bg-slate-800/50 backdrop-blur-lg shadow-lg border border-slate-200 dark:border-slate-700 p-6 flex flex-col items-center text-center gap-4"
        >
          <div
            class="p-1 rounded-full bg-gradient-to-tr from-teal-400 to-cyan-400 mb-2"
          >
            <img
              src="assets/images/profile.jpeg"
              alt="Profile photo of Md Fahim"
              class="w-32 h-32 rounded-full border-4 border-white dark:border-slate-800 shadow-md object-cover"
            />
          </div>
          <h1 class="text-2xl font-bold text-teal-600 dark:text-teal-300">
            Md Fahim
          </h1>
          <p class="text-sm text-slate-500 dark:text-slate-400 -mt-2">
            Exploring Life
          </p>
          <p class="text-sm text-slate-400 dark:text-slate-500 italic">
            "Keep Learning"
          </p>
        </div>
      </aside>

      <!-- MAIN CONTENT -->
      <div class="flex-1 flex flex-col gap-8">
        <section
          id="about-main"
          class="rounded-2xl bg-white/50 dark:bg-slate-800/50 backdrop-blur-lg shadow-lg border border-slate-200 dark:border-slate-700 p-6 flex flex-col gap-2 transition-all duration-300 hover:shadow-xl hover:-translate-y-1"
        >
          <h2 class="text-xl font-bold text-teal-600 dark:text-teal-300 mb-2">
            About Me
          </h2>
          <p class="text-base text-slate-600 dark:text-slate-300 leading-relaxed">
            I'm a passionate researcher and developer with a strong interest in
            building intelligent systems that can learn and reason. My current
            focus is on exploring the frontiers of AI.
          </p>
        </section>

        <div id="dynamic-content-container" class="flex flex-col gap-8"></div>
      </div>
    </main>

    <div id="footer-partial"></div>

    <script src="scripts/partials.js"></script>
    <script>
      const escapeHtml = (unsafe) =>
        unsafe
          ? unsafe
              .replace(/&/g, "&amp;")
              .replace(/</g, "&lt;")
              .replace(/>/g, "&gt;")
              .replace(/"/g, "&quot;")
              .replace(/'/g, "&#039;")
          : "";

      const createSectionCard = (id, icon, title) => {
        const section = document.createElement("section");
        section.id = `${id}-section`;
        section.className =
          "rounded-2xl bg-white/50 dark:bg-slate-800/50 backdrop-blur-lg shadow-lg border border-slate-200 dark:border-slate-700 p-6 flex flex-col transition-all duration-300 hover:shadow-xl hover:-translate-y-1";

        section.innerHTML = `
          <div class="flex items-center gap-3 mb-4">
            <i data-lucide="${icon}" class="w-6 h-6 text-teal-500 dark:text-teal-400"></i>
            <h2 class="text-xl font-semibold text-teal-600 dark:text-teal-400">${title}</h2>
          </div>
          <div id="${id}-content" class="flex flex-col gap-4"></div>
        `;
        return section;
      };

      const sections = [
        {
          id: "news",
          icon: "users",
          title: "Recent News",
          file: "content/co_curricular.md",
          type: "markdown",
        },
        {
          id: "selected_pub",
          icon: "award",
          title: "Selected Publications",
          file: "content/selected_publications.md",
          type: "publication",
        },
      ];

      const container = document.getElementById("dynamic-content-container");

      sections.forEach((sec) => {
        const card = createSectionCard(sec.id, sec.icon, sec.title);
        container.appendChild(card);

        if (sec.type === "markdown") {
          fetch(sec.file)
            .then((res) => res.text())
            .then((md) => {
              document.getElementById(`${sec.id}-content`).innerHTML =
                marked.parse(md);
              lucide.createIcons();
            });
        } else if (sec.type === "publication") {
          fetch(sec.file)
            .then((res) => res.text())
            .then((text) => {
              const entries = text
                .split(/\n\s*\n/)
                .map((b) => b.trim())
                .filter((b) => b && b.includes("[Title]"))
                .map((block) => {
                  const lines = block.split("\n");
                  const f = {};
                  lines.forEach((line) => {
                    const [key, ...rest] = line.split("]");
                    if (key && rest.length) {
                      const field = key.replace("[", "").trim().toLowerCase();
                      f[field] = rest.join("]").trim();
                    }
                  });
                  return f;
                });

              const rendered = entries
                .map((f) => {
                  const imgHtml = f.image
                    ? `<img src="${f.image}" alt="${escapeHtml(
                        f.title
                      )}" class="w-32 h-32 rounded-lg object-cover border border-slate-200 dark:border-slate-700" />`
                    : "";
                  const venueHtml = f.venue
                    ? `<div class="text-sm italic text-slate-500 dark:text-slate-400 mt-1">${escapeHtml(
                        f.venue
                      )}</div>`
                    : "";
                  const yearHtml = f.year
                    ? `<div class="text-slate-600 dark:text-slate-400 ml-auto pl-4">${escapeHtml(
                        f.year
                      )}</div>`
                    : "";
                  const titleHtml = f.title
                    ? `<div class="font-bold text-base text-slate-800 dark:text-white">${escapeHtml(
                        f.title
                      )}</div>`
                    : "";
                  const authorHtml = f.author
                    ? `<div class="text-sm mt-1 mb-2"><span class="text-slate-600 dark:text-slate-300">${f.author
                        .split(",")
                        .map((author) =>
                          author.includes("Md Fahim")
                            ? `<a href="#" class="text-teal-600 dark:text-teal-400 hover:underline">${author.trim()}</a>`
                            : author
                        )
                        .join(", ")}</span></div>`
                    : "";
                  const paperHtml = f.paper
                    ? `<a href="${f.paper.replace(
                        /\[.*\]\((.*)\)/,
                        "$1"
                      )}" target="_blank" class="text-teal-600 dark:text-teal-400 hover:underline mt-1">Paper</a>`
                    : "";

                  return `
                    <div class="flex gap-4 border border-slate-200 dark:border-slate-700 rounded-xl p-4 bg-white/50 dark:bg-slate-800/50 hover:shadow-md transition">
                      ${imgHtml}
                      <div class="flex-1 flex flex-col">
                        <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0">
                          ${titleHtml}
                          ${yearHtml}
                        </div>
                        ${venueHtml}
                        ${authorHtml}
                        ${paperHtml}
                      </div>
                    </div>`;
                })
                .join("");

              document.getElementById(`${sec.id}-content`).innerHTML = rendered;
              lucide.createIcons();
            });
        }
      });
    </script>
  </body>
</html>
